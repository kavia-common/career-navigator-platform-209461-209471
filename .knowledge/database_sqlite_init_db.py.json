{"is_source_file": true, "format": "Python", "description": "This script initializes and seeds an SQLite database for the Career Navigator Platform, creating schema tables related to skills, roles, user progress, learning resources, career paths, and recommendations. It loads configuration from environment variables and JSON seed files, sets up database connections, and writes connection info for external tools.", "external_files": ["seeds/sfia_skills.json", "seeds/roles.json", "seeds/learning_resources.json", "db_visualizer/sqlite.env"], "external_methods": ["os.getenv", "json.load", "Path.exists", "Path.mkdir", "Path.parent", "sqlite3.connect", "os.environ", "Path.resolve"], "published": ["load_env", "create_schema", "seed_from_json", "write_connection_info", "main"], "classes": [], "methods": [{"name": "load_env()", "description": "Loads environment variables, notably SQLITE_DB_PATH, with a default fallback.", "scope": "", "scopeKind": ""}, {"name": "ensure_dirs()", "description": "Ensures that seed and visualization directories exist.", "scope": "", "scopeKind": ""}, {"name": "sqlite3.Connection connect(db_path: str)", "description": "Establishes a SQLite connection with foreign key constraints and journal mode enabled.", "scope": "", "scopeKind": ""}, {"name": "create_schema(conn: sqlite3.Connection)", "description": "Creates database tables, constraints, and indexes if they do not already exist.", "scope": "", "scopeKind": ""}, {"name": "seed_from_json(conn: sqlite3.Connection)", "description": "Loads seed data from JSON files to populate skills, roles, requirements, and learning resources tables, using upsert semantics.", "scope": "", "scopeKind": ""}, {"name": "write_connection_info(db_path: str)", "description": "Writes connection details and environment setup scripts into project files for external use.", "scope": "", "scopeKind": ""}, {"name": "main()", "description": "Main entry point that initializes directories, connects to the DB, creates schema, seeds data, and writes connection info.", "scope": "", "scopeKind": ""}, {"name": "_get_role_id(cur, name)", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "_get_skill_id(cur, code_or_name)", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "_upsert_resource(cur, res)", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "_upsert_resource_skill(cur, resource_id, skill_code_or_name, lv_min, lv_max)", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "_upsert_role(cur, role)", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "_upsert_role_skill_req(cur, role_id, skill_id, target_level, weight)", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "_upsert_skill(cur, skill)", "scope": "", "scopeKind": "", "description": "unavailable"}], "calls": ["connect", "create_schema", "seed_from_json", "write_connection_info", "os.getenv", "Path.exists", "Path.mkdir", "Path.resolve", "json.load", "Path.parent", "sqlite3.connect"], "search-terms": ["init_db.py", "SQLite database initialization", "schema creation", "idempotent seed loading", "seeding JSON files", "Career Navigator platform"], "state": 2, "file_id": 1, "knowledge_revision": 31, "git_revision": "a45691320da4e418bad0c4246608069ad76dbd6b", "revision_history": [{"17": "41f915acbfba7f112b4b10e5cc064b4d43612f98"}, {"20": "41f915acbfba7f112b4b10e5cc064b4d43612f98"}, {"30": "a45691320da4e418bad0c4246608069ad76dbd6b"}, {"31": "a45691320da4e418bad0c4246608069ad76dbd6b"}], "ctags": [{"_type": "tag", "name": "DEFAULT_DB", "path": "/home/kavia/workspace/code-generation/career-navigator-platform-209461-209471/database_sqlite/init_db.py", "pattern": "/^DEFAULT_DB = \"myapp.db\"$/", "language": "Python", "kind": "variable"}, {"_type": "tag", "name": "RESOURCES_FILE", "path": "/home/kavia/workspace/code-generation/career-navigator-platform-209461-209471/database_sqlite/init_db.py", "pattern": "/^RESOURCES_FILE = SEEDS_DIR \\/ \"learning_resources.json\"$/", "language": "Python", "kind": "variable"}, {"_type": "tag", "name": "ROLES_FILE", "path": "/home/kavia/workspace/code-generation/career-navigator-platform-209461-209471/database_sqlite/init_db.py", "pattern": "/^ROLES_FILE = SEEDS_DIR \\/ \"roles.json\"$/", "language": "Python", "kind": "variable"}, {"_type": "tag", "name": "SEEDS_DIR", "path": "/home/kavia/workspace/code-generation/career-navigator-platform-209461-209471/database_sqlite/init_db.py", "pattern": "/^SEEDS_DIR = Path(__file__).parent \\/ \"seeds\"$/", "language": "Python", "kind": "variable"}, {"_type": "tag", "name": "SKILLS_FILE", "path": "/home/kavia/workspace/code-generation/career-navigator-platform-209461-209471/database_sqlite/init_db.py", "pattern": "/^SKILLS_FILE = SEEDS_DIR \\/ \"sfia_skills.json\"$/", "language": "Python", "kind": "variable"}, {"_type": "tag", "name": "_get_role_id", "path": "/home/kavia/workspace/code-generation/career-navigator-platform-209461-209471/database_sqlite/init_db.py", "pattern": "/^def _get_role_id(cur, name):$/", "language": "Python", "kind": "function", "signature": "(cur, name)"}, {"_type": "tag", "name": "_get_skill_id", "path": "/home/kavia/workspace/code-generation/career-navigator-platform-209461-209471/database_sqlite/init_db.py", "pattern": "/^def _get_skill_id(cur, code_or_name):$/", "language": "Python", "kind": "function", "signature": "(cur, code_or_name)"}, {"_type": "tag", "name": "_upsert_resource", "path": "/home/kavia/workspace/code-generation/career-navigator-platform-209461-209471/database_sqlite/init_db.py", "pattern": "/^def _upsert_resource(cur, res):$/", "language": "Python", "kind": "function", "signature": "(cur, res)"}, {"_type": "tag", "name": "_upsert_resource_skill", "path": "/home/kavia/workspace/code-generation/career-navigator-platform-209461-209471/database_sqlite/init_db.py", "pattern": "/^def _upsert_resource_skill(cur, resource_id, skill_code_or_name, lv_min, lv_max):$/", "language": "Python", "kind": "function", "signature": "(cur, resource_id, skill_code_or_name, lv_min, lv_max)"}, {"_type": "tag", "name": "_upsert_role", "path": "/home/kavia/workspace/code-generation/career-navigator-platform-209461-209471/database_sqlite/init_db.py", "pattern": "/^def _upsert_role(cur, role):$/", "language": "Python", "kind": "function", "signature": "(cur, role)"}, {"_type": "tag", "name": "_upsert_role_skill_req", "path": "/home/kavia/workspace/code-generation/career-navigator-platform-209461-209471/database_sqlite/init_db.py", "pattern": "/^def _upsert_role_skill_req(cur, role_id, skill_id, target_level, weight):$/", "language": "Python", "kind": "function", "signature": "(cur, role_id, skill_id, target_level, weight)"}, {"_type": "tag", "name": "_upsert_skill", "path": "/home/kavia/workspace/code-generation/career-navigator-platform-209461-209471/database_sqlite/init_db.py", "pattern": "/^def _upsert_skill(cur, skill):$/", "language": "Python", "kind": "function", "signature": "(cur, skill)"}, {"_type": "tag", "name": "connect", "path": "/home/kavia/workspace/code-generation/career-navigator-platform-209461-209471/database_sqlite/init_db.py", "pattern": "/^def connect(db_path: str) -> sqlite3.Connection:$/", "language": "Python", "typeref": "typename:sqlite3.Connection", "kind": "function", "signature": "(db_path: str)"}, {"_type": "tag", "name": "create_schema", "path": "/home/kavia/workspace/code-generation/career-navigator-platform-209461-209471/database_sqlite/init_db.py", "pattern": "/^def create_schema(conn: sqlite3.Connection):$/", "language": "Python", "kind": "function", "signature": "(conn: sqlite3.Connection)"}, {"_type": "tag", "name": "ensure_dirs", "path": "/home/kavia/workspace/code-generation/career-navigator-platform-209461-209471/database_sqlite/init_db.py", "pattern": "/^def ensure_dirs():$/", "language": "Python", "kind": "function", "signature": "()"}, {"_type": "tag", "name": "load_env", "path": "/home/kavia/workspace/code-generation/career-navigator-platform-209461-209471/database_sqlite/init_db.py", "pattern": "/^def load_env():$/", "language": "Python", "kind": "function", "signature": "()"}, {"_type": "tag", "name": "main", "path": "/home/kavia/workspace/code-generation/career-navigator-platform-209461-209471/database_sqlite/init_db.py", "pattern": "/^def main():$/", "language": "Python", "kind": "function", "signature": "()"}, {"_type": "tag", "name": "seed_from_json", "path": "/home/kavia/workspace/code-generation/career-navigator-platform-209461-209471/database_sqlite/init_db.py", "pattern": "/^def seed_from_json(conn: sqlite3.Connection):$/", "language": "Python", "kind": "function", "signature": "(conn: sqlite3.Connection)"}, {"_type": "tag", "name": "write_connection_info", "path": "/home/kavia/workspace/code-generation/career-navigator-platform-209461-209471/database_sqlite/init_db.py", "pattern": "/^def write_connection_info(db_path: str):$/", "language": "Python", "kind": "function", "signature": "(db_path: str)"}], "hash": "b3b786b2ae48869bc0516c6fb2840e86", "format-version": 4, "code-base-name": "database_sqlite", "filename": "database_sqlite/init_db.py", "fields": [{"name": "DEFAULT_DB = \"myapp.db\"", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "RESOURCES_FILE = SEEDS_DIR \\/ \"learning_resources.json\"", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "ROLES_FILE = SEEDS_DIR \\/ \"roles.json\"", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "SEEDS_DIR = Path(__file__).parent \\/ \"seeds\"", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "SKILLS_FILE = SEEDS_DIR \\/ \"sfia_skills.json\"", "scope": "", "scopeKind": "", "description": "unavailable"}]}